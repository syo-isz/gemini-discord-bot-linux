# Gemini-Tmux Discord Bridge üöÄ

Gemini CLI „Çí Discord „Åã„ÇâÂø´ÈÅ©„ÉªÂÆâÂÖ®„Éª„Çπ„Çø„Ç§„É™„ÉÉ„Ç∑„É•„Å´Êìç‰Ωú„Åô„Çã„Åü„ÇÅ„ÅÆ„Éó„É©„Ç§„Éô„Éº„Éà„Éñ„É™„ÉÉ„Ç∏„ÉÑ„Éº„É´„Åß„Åô„ÄÇ
ÂÖ¨Âºè API „Çí‰ΩøÁî®„Åõ„Åö„ÄÅ**Ë£è„ÅßÁ®ºÂÉç„Åô„Çã `tmux` „Çª„ÉÉ„Ç∑„Éß„É≥„ÅÆÊ®ôÊ∫ñÂá∫Âäõ„Çí„É™„Ç¢„É´„Çø„Ç§„É†„Å´Ëß£Êûê„Åó„Å¶ Discord „Å´ÊµÅ„ÅóËæº„ÇÄ**„Å®„ÅÑ„ÅÜ„ÄÅ„Éè„ÉÉ„Ç´„Éº„É©„Ç§„ÇØ„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„ÇíÊé°Áî®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ

Gemini „ÅåÊÄùËÄÉ„Åó„ÄÅ„ÉÑ„Éº„É´„ÇíÂÆüË°å„Åó„ÄÅÂõûÁ≠î„ÇíÁ∂¥„Çã„Éó„É≠„Çª„Çπ„Çí **2Áßí„Åî„Å®„ÅÆ„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞ÔºàMessage EditÔºâ** „ÅßÂÆüÊ≥Å‰∏≠Á∂ô„Åô„Çã„ÅÆ„ÅåÊúÄÂ§ß„ÅÆÁâπÂæ¥„Åß„Åô„ÄÇ

---

## üåü ‰∏ª„Å™ÁâπÂæ¥

1.  **„É™„Ç¢„É´„Çø„Ç§„É†ÂÆüÊ≥Å‰∏≠Á∂ô (Streaming)**
    *   Gemini „ÅÆÂá∫Âäõ„Çí 2 ÁßíÈñìÈöî„Åß„Çπ„Ç≠„É£„É≥„Åó„ÄÅDiscord ‰∏ä„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂãïÁöÑ„Å´Êõ∏„ÅçÊèõ„Åà„Åæ„Åô„ÄÇ
    *   „Äå‰ªä„Åæ„Åï„Å´ËÄÉ„Åà„Å¶„ÅÑ„Çã„Äç„Äå1Ë°å„Åö„Å§ÂõûÁ≠î„ÅåÁîüÊàê„Åï„Çå„Å¶„ÅÑ„Çã„ÄçÊßòÂ≠ê„Çí„É™„Ç¢„É´„Çø„Ç§„É†„Åß‰ΩìÊÑü„Åß„Åç„Åæ„Åô„ÄÇ
2.  **„Çπ„ÉÉ„Ç≠„É™„Éª„Çπ„Éû„Éº„ÉàËß£Êûê„Ç®„É≥„Ç∏„É≥**
    *   Gemini CLI ÁâπÊúâ„ÅÆÁΩ´Á∑ö„ÇÑ UI „Éé„Ç§„Ç∫Ôºà`‚ï≠‚ïÆ‚ïØ‚ï∞` „Å™„Å©Ôºâ„ÇíÊ≠£Ë¶èË°®Áèæ„ÅßËá™ÂãïÊ∂àÂéª„ÄÇ
    *   „ÉÑ„Éº„É´ÂÆüË°å„É≠„Ç∞Ôºà„Ç≥„Éº„Éâ„Éñ„É≠„ÉÉ„ÇØÔºâ„Å® Gemini „ÅÆÂõûÁ≠îÔºà‚ú¶ Âßã„Åæ„ÇäÔºâ„ÇíËá™ÂãïÂà§Âà•„Åó„ÄÅÁæé„Åó„ÅèÊï¥ÂΩ¢„Åó„Å¶Ë°®Á§∫„Åó„Åæ„Åô„ÄÇ
    *   „É≠„Ç∞ÁµÇ‰∫ÜÂæå„ÄÅÂç≥Â∫ß„Å´„Ç≥„Éº„Éâ„Éñ„É≠„ÉÉ„ÇØ„ÇíÈñâ„Åò„Å¶Ê¨°„ÅÆÊñáÁ´†„Å∏ÁßªË°å„Åô„ÇãÊúÄÈÅ©ÂåñÊ∏à„Åø„ÄÇ
3.  **ÈâÑÂ£Å„ÅÆ„Ç™„Éº„Éä„ÉºÂ∞ÇÁî®„Ç¨„Éº„Éâ**
    *   `.env` „Å´Ë®≠ÂÆö„Åó„Åü„Äå„ÅÇ„Å™„Åü„ÅÆ Discord ID„Äç‰ª•Â§ñ„Åã„Çâ„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÇÑ„Ç≥„Éû„É≥„Éâ„ÇíÂæπÂ∫ïÁöÑ„Å´ÁÑ°Ë¶ñ„ÄÇ
    *   DM „Åß„ÇÇÂÖ¨Èñã„Çµ„Éº„Éê„Éº„Åß„ÇÇ„ÄÅËá™ÂàÜÂ∞ÇÁî®„ÅÆÁßòÊõ∏„Å®„Åó„Å¶ÂÆâÂÖ®„Å´ÈÅãÁî®ÂèØËÉΩ„Åß„Åô„ÄÇ
4.  **Ë©±È°å„Åî„Å®„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ**
    *   `tmux` „Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÂàá„ÇäÊõø„Åà„Çã„Åì„Å®„Åß„ÄÅË©±È°å„Åî„Å®„Å´ Gemini „ÅÆË®òÊÜ∂Ôºà„Éó„É≠„Çª„ÇπÔºâ„ÇíÂÆåÂÖ®„Å´ÂàÜÈõ¢„ÄÇ
    *   „Çµ„Éº„Éì„ÇπÂÜçËµ∑ÂãïÂæå„ÇÇ„ÄÅÂâçÂõû‰ΩøÁî®„Åó„Å¶„ÅÑ„Åü„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíËá™Âãï„ÅßÂæ©ÂÖÉ„Åó„Å¶Á∂ö„Åç„Åã„ÇâÂÜçÈñã„Åß„Åç„Åæ„Åô„ÄÇ

---

## üõ† Âãï‰ΩúÁí∞Â¢É

- **OS**: Linux (Ubuntu 22.04 / 24.04 Êé®Â•®)
- **‰æùÂ≠ò„ÉÑ„Éº„É´**: `tmux`, `Node.js (v24+)`, `Python 3.12+`, `systemd`

---

## üöÄ „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó„Ç¨„Ç§„Éâ (3„Çπ„ÉÜ„ÉÉ„Éó)

### 1. Ê∫ñÂÇô„Å®„Ç§„É≥„Çπ„Éà„Éº„É´
„É™„Éù„Ç∏„Éà„É™„Çí„ÇØ„É≠„Éº„É≥„Åó„Åü„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅßÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
```bash
python -m venv bot_venv
source bot_venv/bin/activate
pip install -r requirements.txt
```

### 2. Áí∞Â¢ÉË®≠ÂÆö (.env)
`.env.example` „Çí `.env` „Å®„ÅÑ„ÅÜÂêçÂâç„Åß„Ç≥„Éî„Éº„Åó„ÄÅ‰ª•‰∏ã„ÅÆÈ†ÖÁõÆ„ÇíÂüã„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
‚ö†Ô∏è **Ê≥®ÊÑè**: `.env` „Å´„ÅØÊ©üÂØÜÊÉÖÂ†±„ÅåÂê´„Åæ„Çå„Åæ„Åô„ÄÇÁµ∂ÂØæ„Å´ÂÖ¨Èñã„É™„Éù„Ç∏„Éà„É™„Å´„Ç≥„Éü„ÉÉ„Éà„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ

```ini
DISCORD_TOKEN=„ÅÇ„Å™„Åü„ÅÆ„Éú„ÉÉ„Éà„Éà„Éº„ÇØ„É≥
DISCORD_CHANNEL_ID=ÂèçÂøú„Åï„Åõ„Åü„ÅÑ„ÉÅ„É£„É≥„Éç„É´ID
MY_DISCORD_ID=„ÅÇ„Å™„Åü„ÅÆDiscord„É¶„Éº„Ç∂„ÉºID (18Ê°Å„ÅÆÊï∞Â≠ó)
GEMINI_EXECUTABLE_PATH=gemini
```
> üí° **ID„ÅÆË™ø„ÅπÊñπ**: Discord „ÅÆ„ÄåË®≠ÂÆö„Äç>„ÄåË©≥Á¥∞Ë®≠ÂÆö„Äç>„ÄåÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„Äç„Çí ON „Å´„Åó„ÄÅËá™ÂàÜ„ÅÆ„Ç¢„Ç§„Ç≥„É≥„ÇíÂè≥„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Äå„É¶„Éº„Ç∂„ÉºID„Çí„Ç≥„Éî„Éº„Äç„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

### 3. Â∏∏Èßê„Çµ„Éº„Éì„ÇπÂåñ (systemd)
‰ª•‰∏ã„Çí `~/.config/systemd/user/gemini-bot.service` „Å´‰øùÂ≠ò„Åó„Åæ„ÅôÔºà„Éá„Ç£„É¨„ÇØ„Éà„É™„Åå„Å™„Åë„Çå„Å∞‰ΩúÊàêÔºâ„ÄÇ
‚Äª `WorkingDirectory` „Å® `ExecStart` „ÅÆ„Éë„Çπ„ÅØ„ÄÅ„ÅîËá™Ë∫´„ÅÆÁí∞Â¢É„Å´Âêà„Çè„Åõ„Å¶ÂøÖ„ÅöÊõ∏„ÅçÊèõ„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

```ini
[Unit]
Description=Gemini Discord Bot
After=network.target

[Service]
Type=simple
WorkingDirectory=/home/ubuntu/gemini-discord-bot
ExecStart=/home/ubuntu/gemini-discord-bot/start.sh
Restart=always
RestartSec=10

[Install]
WantedBy=default.target
```

‰øùÂ≠òÂæå„ÄÅ‰ª•‰∏ã„ÅÆ„Ç≥„Éû„É≥„Éâ„ÅßËµ∑Âãï„ÉªËá™ÂãïËµ∑ÂãïÂåñ„Åó„Åæ„Åô„ÄÇ
```bash
systemctl --user daemon-reload
systemctl --user enable --now gemini-bot.service
```

---

## üéÆ „Ç≥„Éû„É≥„Éâ‰ΩìÁ≥ª

### üí° Gemini CLI „Å∏„ÅÆÂëΩ‰ª§
Gemini Êú¨‰Ωì„ÅÆ„Ç≥„Éû„É≥„ÉâÔºà`/help` „ÇÑ `/reset` „Å™„Å©Ôºâ„ÇíÂëº„Å≥Âá∫„ÅôÈöõ„ÅØ„ÄÅ„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆÂÖàÈ†≠„Å´ `cmd` „Çí‰ªò„Åë„Çã„Åã„ÄÅ„Çπ„É©„ÉÉ„Ç∑„É•„Ç≥„Éû„É≥„Éâ„Çí‰ΩøÁî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ`/` „ÅØ„Ç∑„Çπ„ÉÜ„É†„ÅåËá™ÂãïË£úÂÆå„Åó„Åæ„Åô„ÄÇ

- **„ÉÅ„É£„ÉÉ„ÉàÂÖ•Âäõ**: `cmd help`, `cmd reset`, `cmd file example.md`
- **„Çπ„É©„ÉÉ„Ç∑„É•„Ç≥„Éû„É≥„Éâ**: `/cmd reset` „Å™„Å©

### ‚öôÔ∏è „Éú„ÉÉ„ÉàÁÆ°ÁêÜ („Çπ„É©„ÉÉ„Ç∑„É•„Ç≥„Éû„É≥„Éâ)
„Éú„ÉÉ„ÉàËá™‰Ωì„ÅÆÁä∂ÊÖãÊìç‰Ωú„ÇÑ„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„Å´‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

- `/status`: ÁèæÂú®Êìç‰Ωú„Åó„Å¶„ÅÑ„Çã„Çø„Éº„Ç≤„ÉÉ„Éà„ÅÆ tmux „Çª„ÉÉ„Ç∑„Éß„É≥ÊÉÖÂ†±„ÇíÁ¢∫Ë™ç„ÄÇ
- `/sessions`: Á®ºÂÉç‰∏≠„ÅÆÂÖ®„Çª„ÉÉ„Ç∑„Éß„É≥„Çí„É™„Çπ„Éà„Ç¢„ÉÉ„Éó„ÄÇ
- `/session [name]`: Êìç‰ΩúÂØæË±°„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÂàá„ÇäÊõø„Åà„ÄÇ
- `/session_new [name]`: Êñ∞Ë¶è„Çª„ÉÉ„Ç∑„Éß„É≥„Çí‰ΩúÊàê„Åó„ÄÅGemini CLI „ÇíËµ∑Âãï„ÄÇ
- `/session_kill [name]`: ÊåáÂÆö„Åó„Åü„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÁµÇ‰∫ÜÔºàÊ∂àÂéªÔºâ„ÄÇ

---

## üìÇ „Éï„Ç°„Ç§„É´ÊßãÊàê

- `main.py`: „Éú„ÉÉ„ÉàÊú¨‰ΩìÔºà„É™„Ç¢„É´„Çø„Ç§„É†ÊäΩÂá∫„Éª„Éë„Éº„Çπ„Ç®„É≥„Ç∏„É≥Ôºâ„ÄÇ
- `start.sh`: tmux „ÅÆÊ∫ñÂÇô„ÄÅPIDÁÆ°ÁêÜ„ÄÅ„Åä„Çà„Å≥„Éú„ÉÉ„Éà„ÅÆËµ∑Âãï„Çπ„ÇØ„É™„Éó„Éà„ÄÇ
- `README.md`: Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà„ÄÇ
- `.last_session`: ÊúÄÂæå„Å´‰ΩøÁî®„Åó„Åü„Çª„ÉÉ„Ç∑„Éß„É≥Âêç„ÇíË®òÈå≤„Åô„ÇãÊ∞∏Á∂öÂåñ„Éï„Ç°„Ç§„É´„ÄÇ

---

## ‚ö†Ô∏è ÂÖçË≤¨‰∫ãÈ†Ö (Known Issues)
„Åì„ÅÆ„ÉÑ„Éº„É´„ÅØ Gemini CLI „ÅÆÊ®ôÊ∫ñÂá∫ÂäõÔºà„Çø„Éº„Éü„Éä„É´ UIÔºâ„ÇíÊ≠£Ë¶èË°®Áèæ„ÅßËß£Êûê„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åù„ÅÆ„Åü„ÇÅ„ÄÅGoogle ÂÅ¥„Åå Gemini CLI „ÅÆ„Éó„É≠„É≥„Éó„ÉàË®òÂè∑Ôºà`*` „ÇÑ `‚ú¶`Ôºâ„ÇÑ„É¨„Ç§„Ç¢„Ç¶„Éà‰ªïÊßò„ÇíÂ§âÊõ¥„Åó„ÅüÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅÆ„Éë„Éº„Çπ„ÅåÂ¥©„Çå„Çã„ÄÅ„ÅÇ„Çã„ÅÑ„ÅØ Bot „ÅåÊ≠£Â∏∏„Å´ÂøúÁ≠î„Åó„Å™„Åè„Å™„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
„ÅÇ„Åè„Åæ„ÅßÂÄã‰∫∫Áî®„ÅÆ„Éè„ÉÉ„ÇØ„ÉÑ„Éº„É´„Å®„Åó„Å¶„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ„ÄÇ

---

## üìú „É©„Ç§„Çª„É≥„Çπ (License)
This project is licensed under the MIT License - see the LICENSE file for details.

---
---

# Gemini-Tmux Discord Bridge üöÄ (English Version)

A private bridge tool designed to operate Gemini CLI comfortably, safely, and stylishly from Discord.
Instead of using official APIs, it employs a "hacker-like" approach by **parsing the standard output of a background `tmux` session in real-time and streaming it to Discord**.

The standout feature is its **real-time streaming (Message Edit)**, which provides live updates every 2 seconds as Gemini thinks, executes tools, and writes its response.

---

## üåü Key Features

1.  **Real-time Streaming**
    *   Scans Gemini output every 2 seconds and dynamically updates Discord messages.
    *   Experience the live process of "Thinking" and "Generation" line by line.
2.  **Clean & Smart Parsing Engine**
    *   Automatically strips Gemini CLI-specific borders and UI noise (e.g., `‚ï≠‚ïÆ‚ïØ‚ï∞`) using regex.
    *   Intelligently distinguishes between tool execution logs (code blocks) and Gemini's answers (starting with ‚ú¶).
    *   Optimized to immediately close code blocks and transition to normal text once tool execution finishes.
3.  **Owner-Only Security Shield**
    *   Ignores all messages and commands from anyone other than the Discord ID specified in your `.env`.
    *   Safe to operate as your private AI assistant in DMs or public servers.
4.  **Topic-Based Session Management**
    *   Isolates Gemini's memory/processes by switching between different `tmux` sessions.
    *   Automatically restores the last used session even after a service restart.

---

## üõ† Prerequisites

- **OS**: Linux (Ubuntu 22.04 / 24.04 recommended)
- **Dependencies**: `tmux`, `Node.js (v24+)`, `Python 3.12+`, `systemd`

---

## üöÄ Setup Guide (3 Steps)

### 1. Preparation & Installation
Run these commands in the cloned repository directory:
```bash
python -m venv bot_venv
source bot_venv/bin/activate
pip install -r requirements.txt
```

### 2. Configuration (.env)
Copy `.env.example` to `.env` and fill in the following fields.
‚ö†Ô∏è **Caution**: The `.env` file contains sensitive information. Never commit it to a public repository.

```ini
DISCORD_TOKEN=Your_Bot_Token
DISCORD_CHANNEL_ID=Target_Channel_ID
MY_DISCORD_ID=Your_Discord_User_ID (18-digit number)
GEMINI_EXECUTABLE_PATH=gemini
```
> üí° **How to find your ID**: Enable "Developer Mode" in Discord Settings > Advanced, right-click your profile icon, and select "Copy User ID".

### 3. Service Backgrounding (systemd)
Save the following to `~/.config/systemd/user/gemini-bot.service` (create the directory if it doesn't exist).
*Note: Be sure to update `WorkingDirectory` and `ExecStart` with your absolute paths.*

```ini
[Unit]
Description=Gemini Discord Bot
After=network.target

[Service]
Type=simple
WorkingDirectory=/home/ubuntu/gemini-discord-bot
ExecStart=/home/ubuntu/gemini-discord-bot/start.sh
Restart=always
RestartSec=10

[Install]
WantedBy=default.target
```

Enable and start the service:
```bash
systemctl --user daemon-reload
systemctl --user enable --now gemini-bot.service
```

---

## üéÆ Commands

### üí° Sending Commands to Gemini CLI
To call internal Gemini CLI commands (like `/help` or `/reset`), prefix your message with `cmd` or use the slash command. The `/` prefix is added automatically.

- **Chat Input**: `cmd help`, `cmd reset`, `cmd file example.md`
- **Slash Command**: `/cmd reset` etc.

### ‚öôÔ∏è Bot Management (Slash Commands)
Use these to manage the bot's state and sessions.

- `/status`: Check current target tmux session information.
- `/sessions`: List all active tmux sessions.
- `/session [name]`: Switch the target session.
- `/session_new [name]`: Create a new session and launch Gemini CLI.
- `/session_kill [name]`: Terminate a specific session.

---

## üìÇ File Structure

- `main.py`: Core bot logic (Real-time extraction & parsing).
- `start.sh`: Tmux preparation, PID management, and startup script.
- `README.md`: This documentation.
- `.last_session`: Persistence file to track the last used session.

---

## ‚ö†Ô∏è Disclaimer (Known Issues)
This tool parses the standard output (Terminal UI) of Gemini CLI using regular expressions. If Google changes the prompt symbols (`*` or `‚ú¶`) or layout specifications, parsing may fail or the bot may become unresponsive. This is intended as a personal-use hack tool.

---
Designed with ‚ù§Ô∏è by Gemini CLI (YOLO Mode)
